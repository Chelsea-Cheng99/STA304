---
title: "Newspapers in Times of Low Advertising Revenues"
subtitle: "Reproduce the Paper: A  Difference-in-Differences Analysis"
author: "Xi Cheng"
thanks: "Code are available at: https://github.com/Chelsea-Cheng99/STA304/tree/master/Final"
date: "21 December 2020"
abstract: |
  |  In 2019, researchers Charles Angelucci and Julia Cagé have done the analysis of the relationship between the newspapers’ content and the reduction in advertising revenues. They found robust evidence which demonstrated that a reduction in advertising revenues lowers newspapers’ incentives to produce journalistic-intensive content through the difference-in-differences analysis. In this work, the same dataset was used and the difference-in-differences analysis was applied as well to reproduce their work. In general, similar results were obtained by this work compared to the published paper. 
  |
  | **Keywords:** Newspapers; Difference-in-Differences Analysis; Causal-Inference;  Newspapers’ Content; Advertising Revenues; Number of Journalists;
output:
  pdf_document: 
    latex_engine: lualatex
header_includes: 
   - \usepackage{amsmath} 
   - \usepackage{dcolumn}
toc: FALSE
bibliography: references1.bib
---


```{r setup, include=FALSE, cache = FALSE}
# knitr settings
require("knitr")
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
opts_chunk$set(engine = "R")
knitr::opts_chunk$set(echo = T)
knitr::opts_chunk$set(message = F)
knitr::opts_chunk$set(warning = F)
## setting wd in DELL
# opts_knit$set(root.dir = "~/Documents/")
                                                 
## cache = F, if cache = T, will not revaluate code chunk everytime
## double or more space to insert a line break
```


```{r libs, echo = FALSE, warning= F, include=FALSE}
######################
## Set up workspace
######################
# rm(list = ls())
# load required packages
require(tidyverse)
require(captioner)
require(stargazer)
library(gridExtra)
library(broom)
library(haven)
library(grid)
require(arsenal)
require(magrittr)
require(gtable)
library(RColorBrewer)

options(stringsAsFactors = F)
options(dplyr.width = Inf)
getwd()

# ######## clean memory ######################
# rm(list = ls())
# gc()
# is(dds)
# slotNames(dds)
```



# Introduction

## broader context more detail about what you're interested in, what you did, what you found, why it's important

It has been argued that the information revolution is destroying the traditional newspaper industry around the world right now, from local newspaper to national newspaper. It has been demonstrated that, with the rise of the Internet, the revenues, the advertisers and even the number of journalists employed of the newspaper industry has been steadily decreased, roughly since 2005 (). Therefore, there is a growing concern that the quantity of high-quality content might decrease as well ().
However, the direct accurate causes of the declination of the newspaper remain debatable. Although it is obvious that there is a strong negative correlation between the trend of the Internet and the trend of traditional newspaper industry. One could still argue that, there might exist a third factor such as the changing customer preferences driving both trends (). Similarly, the causality between the decrease in number of journalists employed and the decrease in the advertising revenues remains uncertain as well. Hence, specific hypothesis must be proposed. 


## the research

In their study, they focused on the effects of the decline in advertising revenues on the quality of the newspapers’ content (). To investigate this relationship, they built a model based on several conditions and assumptions, including using a monopoly newspaper which is able to choose the prices of subscription and advertisement, letting readers to be heterogeneous in the types of high-quality content, assuming that more journalist-intensive content increases more costs. 
In terms of the statistical method, the difference-in-differences analysis was applied to derive the causality (). With all above framework, they was trying to prove that a decline in advertising revenues may cause a decline in the amount of high-quality content produced, a drop in reader subscription prices and a change in the composition of readership toward a less wealthy readership ().


## the outline and summary results 


```{r load_data, echo = FALSE, warning = FALSE,message = FALSE}
# the first dataset is for linear regression
dfNews <- read_dta("data/Angelucci_Cage_AEJMicro_dataset.dta")
# others for figures
df1 <- read_dta("data/Angelucci_Cage_AEJMicro_Descriptive_evidence_US.dta")
df23 <- read_dta("data/Angelucci_Cage_AEJMicro_Descriptive_evidence_advertising_industry.dta")
df4 <- read_dta("data/Angelucci_Cage_AEJMicro_Descriptive_evidence_advertisement.dta")
df5 <- read_dta("data/Angelucci_Cage_AEJMicro_Descriptive_evidence_television_quality.dta")

```

# Methods

## Data

The characteristics of data through tables (Table 1. and Table 2.). 




```{r tablesNumber, include=FALSE}
# # numbering of tables with captions 
table_nums <- captioner::captioner(prefix = "Table.")
# Table captions
tab.1_cap <- table_nums(name = "tab_1",
                        caption = "Characteristics Summary of National Daily Newspapers")
tab.2_cap <- table_nums(name = "tab_2",
                        caption = "Characteristics Summary of Local Daily Newspapers")

# results summary table 
tab.3_cap <- table_nums(name = "tab_3",
                        caption = "Advertising Side")
tab.4_cap <- table_nums(name = "tab_4",
                        caption = "Reader Side")
tab.5_cap <- table_nums(name = "tab_5",
                        caption = "Quality")

```


```{r fig1, fig.cap="Newspaper Advertising Revenues (in dollars) and Number of Journalists in the United States, 1980-2015", message = FALSE,echo = FALSE, warning=FALSE, fig.height = 8, fig.width = 6}

fontSize <- 12
# make line and dot plot of figure 1 
p2 <- ggplot(data = df1, mapping = aes(x = year, y = newspapers)) +
   geom_point() +
    geom_line() +
    labs(y = "Advertising Revenues Million US$") + 
    theme_bw()+ 
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")

# make line and dot plot of figure number of journalists 
p3 <- ggplot(data = df1, mapping = aes(x = year, y = nb_journ)) +
   geom_point() +
    geom_line() +
    labs(y = "Number of Journalists") + 
    theme_bw() + 
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")

# combine two plots together 
g2 <- ggplotGrob(p2)
g3 <- ggplotGrob(p3)
g <- rbind(g2, g3, size = "first")
g$widths <- unit.pmax(g2$widths, g3$widths)
grid.draw(g)

```


```{r variables, include = FALSE}
# all variables 
# colnames(dfNews)

############## Advertising side ###################
# ln_ra_cst2 ln_ads_p1_cst2 ln_ads_p4_cst ln_ads_q
# Advertising revenues,  Ad revenues/ circulation, (Listed) ad price, Advertising space

############## Readership ###################

############## Heterogenous Effects: ###################
```

`r table_nums('tab_1')`

```{r table1, fig.cap=tab.1_cap, echo = FALSE}
# Characteristics summary table, EDA stage
# list of variables to make summary table 
my_labels <- list(
  po_cst = "Unit buyer price",
  ps_cst = "Subscription price",
  ads_p4_cst = "Ad rate (listed price)",
  rtotal_cst = "Total revenues (€)",
  ra_cst =  "Revenues from advertising (€)",
  nb_journ = "Number of journalists",
  news_hole = "Newshole (nonadvertising space)"
)

# national data
# # summary table 

table1 <- tableby(~ po_cst + ps_cst + ads_p4_cst + rtotal_cst + ra_cst + nb_journ + news_hole , 
                  data = dfNews[dfNews$national == 1, ])
summary(table1, labelTranslations = my_labels) %>%
   kable()

```


`r table_nums('tab_2')`

```{r table2, fig.cap=tab.2_cap, echo = FALSE}
# list of variables to make summary table 
my_labels <- list(
  po_cst = "Unit buyer price",
  ps_cst = "Subscription price",
  ads_p4_cst = "Ad rate (listed price)",
  rtotal_cst = "Total revenues (€)",
  ra_cst =  "Revenues from advertising (€)",
  nb_journ = "Number of journalists",
  news_hole = "Newshole (nonadvertising space)"
)

# local data
# summary table 

table1 <- tableby(~ po_cst + ps_cst + ads_p4_cst + rtotal_cst + ra_cst + nb_journ + news_hole , 
                  data = dfNews[dfNews$national == 0, ])
summary(table1, labelTranslations = my_labels) %>%
   kable()

```


```{r fig2, fig.cap="Advertising Revenues in France by Media Outlets", message = FALSE,echo = FALSE, warning=FALSE, fig.height = 4, fig.width = 6}
# transform data from wide to long to generate plot 
fontSize <- 12
dftmp <- df23 %>% select(year, adpqn, adpqr, adtv) %>% rename(`National Newspaper` = adpqn,
                                                              `Local Newspaper` = adpqr,
                                                              TVs= adtv) %>% 
    pivot_longer(cols =  `National Newspaper`:TVs, names_to = "Media", values_to = "Advertising Revenues") %>% mutate( Year = factor(year) )

# make plots 
p1 <- ggplot(data = dftmp, aes(x = Media, y = `Advertising Revenues`, fill = Year)) +
    geom_bar(stat = 'identity', position = "dodge" , width = 0.5) +
    theme_bw() + 
    scale_fill_brewer(palette = "Paired") + 
  labs(y = "Advertising Revenues (million euros)") +
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")
p1
```


```{r figure3, fig.cap="Effects on National Newspaper from Advertisment on TV", fig.height = 5.5, fig.width = 8, echo=FALSE}
# factor datasets 
dftmp <- df4 %>% mutate(Year = factor(year))

fontSize <- 12
p1 <- ggplot(data = dftmp, aes(x = Year, y = nb_PQN22)) +
       geom_bar(stat = "identity", width = 0.5, fill = "lightblue") +
       theme_bw() +
     labs(y = "Number of Advertisement (OTC Drugs) in National Newspaper") +
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")

p2 <- ggplot(data = dftmp, aes(x = Year, y = nb_TV22)) +
       geom_bar(stat = "identity", width = 0.5, fill = "navy") +
       theme_bw() +
     labs(y = "Number of Advertisement (OTC Drugs) on TV") +
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")
# combine plots 
grid.arrange(p1, p2, nrow = 1)

```


```{r figure4, fig.cap="Measure of Television Quality", fig.height = 6.5, fig.width = 7, echo=FALSE}
# factor datasets 
# as.numeric(df5$year)
dftmp <- df5 %>% mutate(Year = factor(year), year = as.numeric(year))
# make plots 
fontSize <- 12
p1 <- ggplot(data = dftmp, aes(x = year, y = nb_transmitters_all)) +
       geom_point() + 
      geom_path() + 
       geom_vline(xintercept = 1967, color = "red") +
       theme_bw() +
  scale_x_continuous(breaks  = 1960:1975)  + 
     labs(y = "No. Transmitters of All TV Channels", x = "Year") +
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")

p2 <- ggplot(data = dftmp, aes(x = year, y = journalistes)) +
       geom_point() + 
       geom_vline(xintercept = 1967, color = "red") +
       theme_bw() +
    geom_path() + 
    scale_x_continuous(breaks  = 1960:1975)  + 
     labs(y = "No. Journalists of TV Channels", x = "Year") +
 theme(axis.text.x = element_text(size = fontSize -2, colour = "black"),
      axis.text.y = element_text(size = fontSize - 2, colour = "black"),
      axis.title.x = element_text(size = fontSize),
      axis.title.y = element_text(size = fontSize),
      legend.text = element_text(size= fontSize - 2),
      legend.title = element_text(size= fontSize),
      legend.position="bottom")

# combine plots 
grid.arrange(p1, p2, ncol = 1)
```


## Model

### Model Details

The complete model was shown here: 

\begin{equation}
Revenue \sim Normal(\frac{1}{1 + exp(-(a + b_{i}x_{i} +   ))}) 
\end{equation}

where the $a$ is the intercept, $b$ representing coefficients of different variables. Particularly, $b_{i}$ and $x_{i}$ 

Equation (1) represents the complete model, and Equation (2) represents our final model, which did not include employment status.   

### Model is approriate

### Discussion on features selection.

```{r fitlm1, include=FALSE}
# fit ols linear regression model 
dfNews <- dfNews %>% mutate(year = factor(year), id_news = factor(id_news))

############## Advertising side ###################
# ln_ra_cst2 ln_ads_p1_cst2 ln_ads_p4_cst ln_ads_q
# Advertising revenues,  Ad revenues/ circulation, (Listed) ad price, Advertising space
lm_ra_cst2 <- lm(ln_ra_cst2 ~ after_national + id_news + year, data = dfNews)
lm_ads_p1_cst2 <- lm(ln_ads_p1_cst2 ~ after_national + id_news + year, data = dfNews)
lm_ln_ads_p4_cst <- lm(ln_ads_p4_cst ~ after_national + id_news + year, data = dfNews)
lm_ln_ads_q <- lm(ln_ads_q ~ after_national + id_news + year, data = dfNews)

```


```{r fitlm2, include=FALSE}
# fit ols linear regression model 
dfNews <- dfNews %>% mutate(year = factor(year), id_news = factor(id_news))

############## Reader side ###################
# ln_ps_cst ln_po_cst ln_qtotal ln_qs_s ln_rs_cst
# Subscription price, Unit price, circulation, Share of subscribers, Revenues from sales

lm_ps_cst <- lm(ln_ps_cst ~ after_national + id_news + year, data = dfNews)
lm_po_cst <- lm(ln_po_cst ~ after_national + id_news + year, data = dfNews)
lm_qtotal <- lm(ln_qtotal ~ after_national + id_news + year, data = dfNews)
lm_qs_s <- lm(ln_qs_s ~ after_national + id_news + year, data = dfNews)

lm_rs_cst <- lm(ln_rs_cst ~ after_national + id_news + year, data = dfNews)

```


```{r fitlm3, include=FALSE}
# fit ols linear regression model 
dfNews <- dfNews %>% mutate(year = factor(year), id_news = factor(id_news))

############## Quality ###################
# ln_nb_journ ln_av_payroll_cst ln_pages ln_news_hole
# Number of journalists, Average payroll, Number of pages, Newshole, Share of hard news on front page (percent)
lm_nb_journ <- lm(ln_nb_journ ~ after_national + id_news + year, data = dfNews)
lm_av_payroll <- lm(ln_av_payroll_cst ~ after_national + id_news + year, data = dfNews)
lm_pages <- lm(ln_pages ~ after_national + id_news + year, data = dfNews)
lm_news_hole <- lm(ln_news_hole ~ after_national + id_news + year, data = dfNews)

```




All work were done in `R` (version 4.0.2) [@R-base] and `Rstudio` (version 1.3.1093). `Tidyverse` (version 1.3.0) was used for data wrangling and the `ggplot2` of the `Tidyverse` was used for visualization [@Tidyverse]. R package `Haven` was used to import the dataset. There are other packages used, including `captioner`, `gridExtra`, `broom`, `stargazer`, `RColorBrewer`, `Haven`, `magrittr`, `knitr`, `labelled` and `arsenal` [@Captioner; @Stargazer; @Arsenal; @Knitr; @Haven; @gridExtra; @Broom; @magrittr; @Labelled; @RCB; @gtable]. Code are available at: https://github.com/Chelsea-Cheng99/STA304/tree/master/Final. 



# Results

`r table_nums('tab_3')`

```{r table3, fig.cap=tab.3_cap, echo = FALSE, results='asis'}
# fit all lms 
# summary table 
# summary table of lm regression results 
stargazer(lm_ra_cst2, lm_ads_p1_cst2, lm_ln_ads_p4_cst , lm_ln_ads_q, 
          # title="Results",
          #  align=TRUE,
           column.labels = c("Ad Revenues", "Ad Revenues (per)", "Ad Listed Price", "Ad Space"),
          dep.var.labels.include = FALSE,
          report = "vct*",
          omit = c("id_news", "year"),
          model.names = FALSE, 
           covariate.labels = c("National × Post-TV ad", "Intercept") ,
          type='latex', header=FALSE,
          omit.stat = c("ser", "f") )

```


`r table_nums('tab_4')`

```{r tb4, echo = FALSE, results='asis', fig.cap=tab.4_cap}

# Subscription price, Unit price, circulation, Share of subscribers, Revenues from sales

# summary table of lm regression results 
stargazer(lm_ps_cst, lm_po_cst, lm_qtotal, lm_qs_s, lm_rs_cst,
          # title="Results",
          #  align=TRUE,
           column.labels = c("Sub. Price", "Unit Price", 
                             "Circulation", "Share of Sub.", "Revenues (sales)"),
          dep.var.labels.include = FALSE,
          report = "vct*",
          omit = c("id_news", "year"),
          model.names = FALSE, 
           covariate.labels = c("National × Post-TV ad", "Intercept") ,
          type='latex', header=FALSE,
          omit.stat = c("ser", "f") )


```


`r table_nums('tab_5')`

```{r tb5, echo = FALSE, results='asis', fig.cap=tab.5_cap}
############## Quality ###################
# ln_nb_journ ln_av_payroll_cst ln_pages ln_news_hole
# Number of journalists, Average payroll, Number of pages, Newshole, Share of hard news on front page (percent)

# summary table of lm regression results 
stargazer(lm_nb_journ, lm_av_payroll, lm_pages, lm_news_hole,
          # title="Results",
          #  align=TRUE,
           column.labels = c("No. Journalists", "Average Payroll", 
                             "No. Pages", "Newshole"),
          dep.var.labels.include = FALSE,
          report = "vct*",
          omit = c("id_news", "year"),
          model.names = FALSE, 
           covariate.labels = c("National × Post-TV ad", "Intercept") ,
          type='latex', header=FALSE,
          omit.stat = c("ser", "f") )


```

# Discussion

## Interpretation of results    

## What have we learnt from the model

Detailed information of the final model fitting can be found in the **Appendix**.  


All statistical modeling has two frames: the small world of the model itself and the large world we hope to deploy the model in.

## The sex and gender problem in modern survey

It is worthwhile mentioning that 

## Weaknesses and next steps

As we mentioned above, 


\newpage

# Appendix {-}

```{r edafigures, fig.width = 4, fig.height= 3, echo=FALSE}


```

\newpage


# References


